# Sandbox Application for Binary Analysis
Rudimentary Sandbox Application for Binary Analysis on Linux Systems

## Conceptualization:

The application/service involves multiple core processes working together to incorporate hash based and behaviour based checking for every binary to assess its status.
This is to be done while maintaining the sanctity of our host machine from possible residue left by the test binary/script.

## Design Document

The application utilizes multiple processes co-ordinating to analyse the binary in 3 ways.

1. Short-term Analysis

This involves checking the hash of the uploaded binary in 5 major Malware Hash datasets.

This process is expected to be fast and the result should be displayed well within 30s.

VirusTotal, NSRL, MalwareBazar etc.

1. Binary Processing and Behavioural Analysis:

This step would analyse the contents of the binary using YARA and ClamAV.

This will require integrating existing open-source YARA rules into the model. Custom rules can also be added.

Lynis can also be integrated, but let us go ahead with these 2 options first. [System Call Analysis]

1. ML based Binary Analysis: [Ambitious for now]

These models can be used for static as well as dynamic analysis of the binaries.

Dynamic processing would require the model to be compatible with the event bracket OR the system call stack that we are planning to incorporate.

## Design Diagram:
Design_diagram.png

## High Level Workflow:

1. The application keeps a container running all the time [# can be increased based on the incoming requests]

1. The user uploads a binary/shell script through the UI of the webapp which is compressed/serialized and sent directly inside the container where it is de-compressed/de-serialized.

1. The service running inside the container calculates the SHA256 and MD5 hashes of the binary and communicates them to the host machine.

1. The service running on the main machine compares the hashes with the entries available in the malware hash dataset.

1. A thread of the service running inside the container does the binary analysis based on YARA rules [Static Analysis]. This requires YARA rules to be present on the container. Similar process can be deployed for the ClamAV but we might need to use their library for APIs.

1. Another thread running inside the container will collect the events generated by the binary. These will be:

-   Cross-procs [Cross Process Communication Events]
-   File mods [File Modification Events]
-   Reg mods [Registry Modifications]
-   Mod loads [Unidentified Kernel Module Loads]
-   Netconn [Net connection Events]

Apart from these we will also log the system calls generated by the binary using tools like strace etc. [This might be helpful in the future]

1. All of the services independently report their findings to the main machine and then to the webapp for the user to view.
